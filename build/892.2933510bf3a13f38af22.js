"use strict";(self.webpackChunkpayload_blog=self.webpackChunkpayload_blog||[]).push([[892],{6892:(e,a,l)=>{l.r(a),l.d(a,{default:()=>b});var r=l(7294),o=l(8439),n=l(546),t=l(4479),s=l(8285),i=l(7578),d=l(4012),c=l(3864),u=l(8170),m=l(666),p=l(5193),w=l(4945),h=l(7070);l(5396);const v="field-type array",E=r.memo((e=>{const{onDragEnd:a,label:l,showError:n,errorMessage:i,rows:d,labels:c,addRow:u,removeRow:p,moveRow:E,path:b,fieldTypes:y,fields:R,permissions:g,value:f,readOnly:x,minRows:k,maxRows:_,required:I,description:O}=e,Z=_&&d.length>=_;return r.createElement(o.Z5,{onDragEnd:a},r.createElement("div",{className:v},r.createElement("div",{className:`${v}__error-wrap`},r.createElement(m.Z,{showError:n,message:i})),r.createElement("header",{className:`${v}__header`},r.createElement("h3",null,l),r.createElement(h.Z,{value:f,description:O})),r.createElement(o.bK,{droppableId:"array-drop"},(e=>r.createElement("div",{ref:e.innerRef,...e.droppableProps},d.length>0&&d.map(((e,a)=>r.createElement(s.Z,{readOnly:x,key:e.id,id:e.id,blockType:"array",label:c.singular,rowCount:d.length,rowIndex:a,addRow:u,removeRow:p,moveRow:E,parentPath:b,fieldTypes:y,fieldSchema:R,permissions:g,hasMaxRows:Z}))),(d.length<k||I&&0===d.length)&&r.createElement(w.Z,{type:"error"},"This field requires at least"," ",k?`${k} ${c.plural}`:`1 ${c.singular}`),0===d.length&&x&&r.createElement(w.Z,null,"This field has no"," ",c.plural,"."),e.placeholder))),!x&&!Z&&r.createElement("div",{className:`${v}__add-button-wrap`},r.createElement(t.Z,{onClick:()=>u(f),buttonStyle:"icon-label",icon:"plus",iconStyle:"with-border",iconPosition:"left"},`Add ${c.singular}`))))})),b=(0,n.Z)((e=>{var a,l;const{name:o,path:n,fields:t,fieldTypes:s,validate:m=p.array,required:w,maxRows:h,minRows:v,permissions:b,admin:{readOnly:y,description:R,condition:g}}=e,f=(null==(x=e)?void 0:x.labels)?x.labels:(null==x?void 0:x.label)?{singular:x.label,plural:void 0}:{singular:"Row",plural:"Rows"};var x;const k=null!==(a=null==e?void 0:e.label)&&void 0!==a?a:null===(l=null==e?void 0:e.labels)||void 0===l?void 0:l.singular,[_,I]=(0,r.useReducer)(i.Z,[]),O=(0,d.cI)(),{dispatchFields:Z}=O,T=n||o,C=(0,r.useCallback)((e=>m(e,{minRows:v,maxRows:h,required:w})),[m,h,v,w]),[D,M]=(0,r.useState)(!1),{showError:$,errorMessage:F,value:S,setValue:q}=(0,u.Z)({path:T,validate:C,disableFormData:D,ignoreWhileFlattening:!0,condition:g}),V=(0,r.useCallback)((async e=>{const a=await(0,c.Z)(t);Z({type:"ADD_ROW",rowIndex:e,subFieldState:a,path:T}),I({type:"ADD",rowIndex:e}),q(S+1)}),[I,Z,t,T,q,S]),A=(0,r.useCallback)((e=>{I({type:"REMOVE",rowIndex:e}),Z({type:"REMOVE_ROW",rowIndex:e,path:T})}),[I,Z,T]),N=(0,r.useCallback)(((e,a)=>{I({type:"MOVE",moveFromIndex:e,moveToIndex:a}),Z({type:"MOVE_ROW",moveFromIndex:e,moveToIndex:a,path:T})}),[I,Z,T]),P=(0,r.useCallback)((e=>{if(!e.destination)return;const a=e.source.index,l=e.destination.index;N(a,l)}),[N]);return(0,r.useEffect)((()=>{const e=O.getDataByPath(T);I({type:"SET_ALL",data:e||[]})}),[O,T]),(0,r.useEffect)((()=>{q((null==_?void 0:_.length)||0),0===(null==_?void 0:_.length)?M(!1):M(!0)}),[_,q]),r.createElement(E,{onDragEnd:P,label:k,showError:$,errorMessage:F,rows:_,labels:f,addRow:V,removeRow:A,moveRow:N,path:T,name:o,fieldTypes:s,fields:t,permissions:b,value:S,readOnly:y,minRows:v,maxRows:h,required:w,description:R})}))}}]);